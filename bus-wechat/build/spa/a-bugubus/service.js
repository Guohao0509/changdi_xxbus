app.service("$myLocationService",function(e){var t=document.createElement("div");t.id="map"+(new Date).getTime(),t.style="width:0;height:0",document.body.appendChild(t);var o,a,i;o=new AMap.Map(t.id,{resizeEnable:!0}),i=new AMap.Geocoder({radius:1e3,city:"027",extensions:"all"}),this.getCurrentPosition=function(e){o.plugin("AMap.Geolocation",function(){(a=new AMap.Geolocation({enableHighAccuracy:!0,convert:!0})).getCurrentPosition(),AMap.event.addListener(a,"complete",function(t){i.getAddress(t.position,function(t,o){"complete"===t&&"OK"===o.info&&e(o.regeocode.pois&&o.regeocode.pois.length>0?o.regeocode.pois:[])})}),AMap.event.addListener(a,"error",function(e){alert("您禁止了授权定位信息,若想继续操作请输入地址信息")})})},this.getPoisByLngLat=function(e,t){i.getAddress(e,function(e,o){"complete"===e&&"OK"===o.info&&t(o.regeocode.pois&&o.regeocode.pois.length>0?o.regeocode.pois:[])})},this.AddressByKeyword=function(e,t){i.getLocation(e,function(e,t){console.log(e),"complete"===e&&"OK"===t.info&&(console.log(t),t.geocodes.pois&&t.regeocode.pois.length)})},this.getPoisByKeyword=function(e,t){AMap.service(["AMap.Autocomplete"],function(){var o=new AMap.Autocomplete({city:"武汉",datatype:"all"});e.length>0&&o.search(e,function(e,o){"complete"==e?t(o.tips):"no_data"==e&&t([])})})}}).service("$myHttpService",function(e,t,o){this.post=function(a,i,n,c){t.show(),e.post(a,i).success(function(e){if(window.setTimeout(function(){t.hide()},250),0==e.code){if(0==e.data.flag)return void o.go("auth.login",{},{location:"replace"});n(e.data)}else{var a="";a=e.data.msg?e.data.msg:e.data,layer?layer.alert(a):alert(a),c&&c(e.data)}}).error(function(e){t.hide(),layer?layer.alert(e.message):alert(e.message),c&&c(e)})},this.postNoLoad=function(t,o,a,i){e.post(t,o).success(function(e){if(0==e.code)a(e.data);else{var t="";t=e.data.msg?e.data.msg:e.data,layer?layer.alert(t):alert(t),i&&i(e.data)}}).error(function(e){layer?layer.alert(e.message):alert(e.message),i&&i(e)})},this.get=function(o,a,i,n){t.show(),e.get(o,a).success(function(e){if(t.hide(),0==e.code)i(e.data);else{var o="";o=e.data.msg?e.data.msg:e.data,layer?layer.alert(o):alert(o),n&&n(e.data)}}).error(function(e){t.hide(),layer?layer.alert(e.message):alert(e.message),n&&n(e)})}}).service("$selectCity",function(){this.getCity=function(e){(new AMap.CitySearch).getLocalCity(function(t,o){"complete"===t&&"OK"===o.info&&e(o&&o.city?o.city:[])})}});