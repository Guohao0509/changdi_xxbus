var app=angular.module("app").controller("bus_service_1",function(e,t,a,r,o,s,n,i){if(t.onewayformdata={},t.backformdata={},t.thenerveformadata={},t.ioncheck={},t.onTabSelected=function(e){t.charterType=e},t.ioncheck.checked=!1,e.startLocation){d=e.startLocation;t.startLocation=d.name,t.startLocationlnglat=d.lngLat}else o.getCurrentPosition(function(a){if(a.length>0){var a=a[0];e.startLocation={name:a.name,lngLat:a.location.lng+","+a.location.lat},t.startLocation=a.name,t.startLocationlnglat=a.location.lng+","+a.location.lat,t.$apply()}else t.startLocation="无法获取你的位置",t.startLocationlnglat="0,0",t.$apply()});if(e.endLocation){var d=e.endLocation;t.endLocation=d.name,t.endLocationlnglat=d.lngLat}t.selectLocation=function(e,t){a.go("select_location",{params:e,status:t})},t.onewayformdata={StartTime:"出发时间",charterStartTime:new Date,EndTime:"结束时间",charterEndTime:new Date},t.backformdata={StartTime:"出发时间",charterStartTime:new Date,EndTime:"结束时间",charterEndTime:new Date},t.thenerveformadata={StartTime:"出发时间",charterStartTime:new Date,EndTime:"结束时间",charterEndTime:new Date},t.gotobusservice3=function(o,s,n){t.userid=e.session.user.userInfo.userid;var i={};1==t.charterType?i={userid:t.userid,startLocation:o,startLoLa:t.startLocationlnglat,endLocation:s,endLoLa:t.endLocationlnglat,charterType:t.charterType,needInfo:t.ioncheck.checked,charterStartTime:r("date")(t.onewayformdata.charterStartTime,"yyyy-MM-dd HH:mm"),charterEndTime:r("date")(t.onewayformdata.charterEndTime,"yyyy-MM-dd HH:mm"),charterCount:t.onewayformdata.charterCount}:2==t.charterType?i={userid:t.userid,startLocation:o,startLoLa:t.startLocationlnglat,endLocation:s,endLoLa:t.endLocationlnglat,charterType:t.charterType,needInfo:t.ioncheck.checked,charterStartTime:r("date")(t.backformdata.charterStartTime,"yyyy-MM-dd HH:mm"),charterEndTime:r("date")(t.backformdata.charterEndTime,"yyyy-MM-dd HH:mm"),charterCount:t.backformdata.charterCount}:3==t.charterType&&(i={userid:t.userid,startLocation:o,startLoLa:t.startLocationlnglat,endLocation:s,endLoLa:t.endLocationlnglat,charterType:t.charterType,needInfo:t.ioncheck.checked,charterStartTime:r("date")(t.thenerveformadata.charterStartTime,"yyyy-MM-dd HH:mm"),charterEndTime:r("date")(t.thenerveformadata.charterEndTime,"yyyy-MM-dd HH:mm"),charterCount:t.thenerveformadata.charterCount});var d=/[^\d]/g;if(void 0!=i.endLocation&&""!=i.endLocation)if(d.test(i.charterCount))layer.msg("请输入正确的乘车人数");else{t.formtime={oneformstartdate:r("date")(t.onewayformdata.charterStartTime,"yyyy-MM-dd HH:mm"),oneformendtime:r("date")(t.onewayformdata.charterEndTime,"yyyy-MM-dd HH:mm"),twoformstartdate:r("date")(t.backformdata.charterStartTime,"yyyy-MM-dd HH:mm"),twoformendtime:r("date")(t.backformdata.charterEndTime,"yyyy-MM-dd HH:mm"),thereformstartdate:r("date")(t.thenerveformadata.charterStartTime,"yyyy-MM-dd HH:mm"),thereformendtime:r("date")(t.thenerveformadata.charterEndTime,"yyyy-MM-dd HH:mm")};var c=new Date,u=c.getMonth()+1,l=c.getDate(),m=c.getHours(),p=c.getMinutes();u<10&&(u="0"+u),l<10&&(l="0"+l),m<10&&(m="0"+m),p<10&&(p="0"+p);var f=c.getFullYear()+"-"+u+"-"+l+" "+m+":"+p;if(1==i.charterType){if(t.formtime.oneformstartdate>t.formtime.oneformendtime)return layer.msg("结束时间不能小于开始时间"),!1;if(t.formtime.oneformstartdate==t.formtime.oneformendtime)return layer.msg("请输入正确的时间"),!1;if(t.formtime.oneformstartdate<f)return layer.msg("出发时间已经过了哦"),!1;if(t.formtime.oneformendtime<f)return layer.msg("结束时间已经过了哦"),!1}else if(2==i.charterType){if(t.formtime.twoformstartdate>t.formtime.twoformendtime)return layer.msg("结束时间不能小于开始时间"),!1;if(t.formtime.twoformstartdate==t.formtime.twoformendtime)return layer.msg("请输入正确的时间"),!1;if(t.formtime.twoformstartdate<f)return layer.msg("出发时间已经过了哦"),!1;if(t.formtime.twoformendtime<f)return layer.msg("结束时间已经过了哦"),!1}else if(3==i.charterType){if(t.formtime.thereformstartdate>t.formtime.thereformendtime)return layer.msg("结束时间不能小于开始时间"),!1;if(t.formtime.thereformstartdate==t.formtime.thereformendtime)return layer.msg("请输入正确的时间"),!1;if(t.formtime.thereformstartdate<f)return layer.msg("出发时间已经过了哦"),!1;if(t.formtime.thereformendtime<f)return layer.msg("结束时间已经过了哦"),!1}a.go("bus_service_mess",{usermessobj:JSON.stringify(i)})}else layer.msg("请输入目的地")}}).controller("bus_service_2",function(e,t,a,r){t.argee=!0,t.agreeChange=function(){t.argee=!t.argee},t.usermesschartype={1:"单程",2:"往返",3:"包天"},t.needinfotype={true:"需要司机",false:"不需要司机"},t.usermessobj=JSON.parse(a.params.usermessobj),t.usermessobj.charterCount=parseInt(t.usermessobj.charterCount),t.buservice=function(){var e=/^[\u4e00-\u9fa5]{2,4}$/;if(void 0==t.usermessobj.commName)return layer.msg("请输入联系人昵称"),!1;if(!e.test(t.usermessobj.commName))return layer.msg("请输入正确的联系人昵称"),!1;var o=/^1[34578]\d{9}$/;return void 0==t.usermessobj.commMobile||""==t.usermessobj.commMobile?(layer.msg("请输入联系方式"),!1):o.test(t.usermessobj.commMobile)?(console.log(t.usermessobj.repInfo),void 0!=t.usermessobj.repInfo&&""!=t.usermessobj.repInfo&&t.usermessobj.repInfo.length>100?(layer.msg("输入内容长度不能超过100个字,请重新输入"),!1):void r.post("api/charterOrder/newCharterCase",t.usermessobj,function(e){a.go("bus_submit_success",{charterid:e.charterid,caseStatus:e.caseStatus},{location:"replace"})})):(layer.msg("请输入正确的联系方式"),!1)}}).controller("bus_service_all",function(e,t,a,r,o,s){e.caseStatus=o.params.caseStatus,e.usercharteridmess={charterid:o.params.charterid},a.post("api/charterOrder/CharterCaseDetails",e.usercharteridmess,function(t){e.usermess={userid:t.userid,startLocation:t.startLocation,endLocation:t.endLocation,charterStartTime:t.charterStartTime,charterEndTime:t.charterEndTime,charterCount:t.charterCount,charterType:t.charterType,commName:t.commName,commMobile:t.commMobile,reqInfo:t.reqInfo,caseStatus:t.caseStatus,totalfee:t.totalfee,needInfo:t.needInfo},console.log(JSON.stringify(t))}),e.charterTypestaus={1:"单程",2:"往返",3:"包天"},e.usercaseStatus={1:"待审核",2:"审核失败",3:"未支付",4:"支付失败",5:"已支付",6:"已完成"},e.needinfostaus={true:"需要司机",false:"不需要司机"},e.pay=function(){"1"==e.usermess.caseStatus?layer.msg("请等待管理员审核"):"3"==e.usermess.caseStatus||"4"==e.usermess.caseStatus?o.go("bus_service_pay",{totalfee:e.usermess.totalfee,charterid:e.usercharteridmess.charterid}).replace():"5"!=e.usermess.caseStatus&&"6"!=e.usermess.caseStatus||layer.msg("此订单已完成")}}).controller("charterpayController",function(e,t,a,r,o){e.totalfee=o.params.totalfee,e.charterid=o.params.charterid,e.nextpay=function(){t.post("api/payOrder/newPayCase",{charterid:e.charterid,userid:a.session.user.userInfo.userid,openid:a.session.user.userInfo.openid},function(a){function o(){WeixinJSBridge.invoke("getBrandWCPayRequest",a,function(o){"get_brand_wcpay_request:ok"==o.err_msg?t.post("api/payOrder/verifyWxorderStatus",{rechargeid:a.rechargeid},function(t){alert("您本次成功充值了"+e.totalfee+"元"),r.url("/bus_service_history").replace()},function(e){alert("支付失败，请联系客服处理。")}):"get_brand_wcpay_request:cancel"==o.err_msg?alert("你取消了本次支付"):alert("支付失败，请联系客服处理。")})}"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",o,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",o),document.attachEvent("onWeixinJSBridgeReady",o)):o()})}}).controller("bus_submit_success",function(e,t,a){e.caseStatus=a.params.caseStatus,e.charterid=a.params.charterid,e.querystuts=function(){a.go("bus_service_all",{caseStatus:e.caseStatus,charterid:a.params.charterid}).replace()}}).controller("bus_service_history",function(e,t,a,r,o,s,n,i){e.userallmess=[],e.offset=0,e.pagesize=20,e.count=0,e.showMoreBtn=!1,e.getData=function(){a.post("api/charterOrder/queryOrderRecords",{userid:r.session.user.userInfo.userid,offset:e.offset,pagesize:e.pagesize},function(t){e.totalnum=t.totalnum,e.queryusertype={1:"单程",2:"往返",3:"包天"},e.queryuserstaus={1:"待审核",2:"审核失败",3:"未支付",4:"支付失败",5:"已支付",6:"已完成"},e.totalnum-(e.offset+e.pagesize)>0?e.showMoreBtn=!0:e.showMoreBtn=!1,e.$broadcast("scroll.refreshComplete"),e.userallmess=t.body,window.setTimeout(function(){n.resize()},0)})},e.bus_service_all=function(e){i.go("bus_service_all",{charterid:e.charterid,caseStatus:e.caseStatus})},e.getData(),e.refresh=function(){e.offset=0,a.postNoLoad("api/charterOrder/queryOrderRecords",{userid:r.session.user.userInfo.userid,offset:e.offset,pagesize:e.pagesize},function(t){e.totalnum=t.totalnum,e.totalnum-(e.offset+e.pagesize)>0?e.showMoreBtn=!0:e.showMoreBtn=!1,e.$broadcast("scroll.refreshComplete"),e.userallmess=t.body,window.setTimeout(function(){n.resize()},0),layer.msg("刷新成功")})},e.getMoreData=function(){e.offset=e.offset+e.pagesize,a.post("api/charterOrder/queryOrderRecords",{userid:r.session.user.userInfo.userid,offset:e.offset,pagesize:e.pagesize},function(t){e.totalnum=t.totalnum,e.totalnum-(e.offset+e.pagesize)>0?e.showMoreBtn=!0:e.showMoreBtn=!1,e.userallmess=e.userallmess.concat(t.body),window.setTimeout(function(){n.resize()},0)})}}).controller("ScheduleTicketPay",function(e,t,a,r,o,s,n,i){var d=null===i.localStorage.getItem("saveMess")?[]:JSON.parse(i.localStorage.getItem("saveMess"));t.agreeStatus=!0,t.agreeStatusChange=function(){t.agreeStatus=!t.agreeStatus},t.orderInfo={payType:"0"},t.status=!1,t.moneypay={},t.moneypay.checked=!1,t.orderInfo.payType=!0,0==o.chargingtype&&s.post("api/busline/queryCycleBusSchedulePrice",{bsid:o.bsid,userid:e.session.user.userInfo.userid,pdepartaddr:o.staddr,parriveaddr:o.edaddr},function(e){var a={bsid:e.busSchedule.bsid,linename:e.busSchedule.linename,depart:e.pdepartaddr,arrive:e.parriveaddr,totalMoney:parseFloat(o.addprice),plateNum:e.busSchedule.platenum,goDepartTime:e.busSchedule.departtime,backDepartTime:e.busSchedule.arrivetime,startDate:e.startdate,endDate:e.enddate},r=new Date(e.startdate);if(a.year=r.getFullYear(),a.month=r.getMonth()+1,a.chargingtype=o.chargingtype,t.status=!0,d.length>0){for(var s=!1,i=0;i<d.length;i++)if(a.bsid==d[i].bsid&&d[i].chargingtype==a.chargingtype&&d[i].depart==a.depart&&d[i].arrive==a.arrive){s=!0,layer.msg("请勿重复选择车票");break}s||d.push(a)}else d.push(a);t.orderList=d;for(var c=0,u=0;u<t.orderList.length;u++)c+=t.orderList[u].totalMoney;t.orderList.ticketmoney=c;for(var l=[],m=0;m<d.length;m++)l.push(d[m].bsid+"&"+n("date")(d[m].startDate,"yyyy-MM-dd")+"&"+d[m].chargingtype+"&"+d[m].depart+"&"+d[m].arrive);t.tickeObj=l}),2==o.chargingtype&&s.post("api/busline/queryCycleBusScheduleSinglePrice",{userid:e.session.user.userInfo.userid,bsid:o.bsid,pdepartaddr:o.staddr,parriveaddr:o.edaddr},function(e){var a={bsid:e.busSchedule.bsid,linename:e.busSchedule.linename,depart:e.pdepartaddr,arrive:e.parriveaddr,totalMoney:parseFloat(o.addprice),plateNum:e.busSchedule.platenum,goDepartTime:e.busSchedule.departtime,backDepartTime:e.busSchedule.backDeparttime,startDate:e.usedate,endDate:e.enddate,price:e.busSchedule.price},r=new Date(e.usedate);if(a.year=r.getFullYear(),a.month=r.getMonth()+1,a.day=r.getDate(),a.chargingtype=o.chargingtype,t.status=!0,d.length>0){for(var s=!1,n=0;n<d.length;n++)if(a.bsid==d[n].bsid&&d[n].chargingtype==a.chargingtype&&d[n].depart==a.depart&&d[n].arrive==a.arrive){s=!0,layer.msg("请勿重复选择车票");break}s||d.push(a)}else d.push(a);t.orderList=d;for(var i=0,c=0;c<t.orderList.length;c++)i+=t.orderList[c].totalMoney;t.orderList.ticketmoney=i}),t.setObject=function(e,t){i.localStorage[e]=angular.toJson(t),r.go("schedule_opened")},t.removeDate=function(e){d.splice(e,1),i.localStorage.saveMess=angular.toJson(d),t.$watch("orderList",function(){for(var e=0,a=0;a<t.orderList.length;a++)e+=t.orderList[a].totalMoney;t.orderList.ticketmoney=e,""==t.orderList&&(t.status=!0,t.status=!t.status)})},t.selectDate=function(){a.url("/schedule_opened").replace()},s.post("api/user/queryUserBarcode",{userid:e.session.user.userInfo.userid},function(e){t.balance=parseFloat(e.user.balance)}),t.submitOrder=function(){if(0==t.orderInfo.payType&&1==t.moneypay.checked){if(0==t.balance)return void layer.msg("储值卡余额不足，请更换支付方式");if(t.balance<t.orderList.ticketmoney)return void layer.msg("储值卡余额不足，请更换支付方式")}if(0!=t.orderInfo.payType||0!=t.moneypay.checked)if(1==t.moneypay.checked&&1==t.orderInfo.payType&&t.balance>t.orderList.ticketmoney)layer.msg("您的余额充裕,请使用储值卡支付");else{for(var r=[],o=0;o<t.orderList.length;o++)r.push(t.orderList[o].bsid+"&"+n("date")(t.orderList[o].startDate,"yyyy-MM-dd")+"&"+t.orderList[o].chargingtype+"&"+d[o].depart+"&"+d[o].arrive);t.tickeObj=r,s.post("api/busline/buyMonthTicket",{userid:e.session.user.userInfo.userid,openid:e.session.user.userInfo.openid,bsid:t.tickeObj,moneycar:t.moneypay.checked},function(e){function r(){WeixinJSBridge.invoke("getBrandWCPayRequest",e,function(r){"get_brand_wcpay_request:ok"==r.err_msg?s.post("api/recharge/verifyWxorderStatus",{rechargeid:e.rechargeid},function(e){i.localStorage.clear(),a.url("/ticket/pay_success?orderList="+JSON.stringify(t.orderList)).replace()},function(e){alert("支付失败，请联系客服处理。")}):"get_brand_wcpay_request:cancel"==r.err_msg?alert("你取消了本次支付"):alert("支付失败，请联系客服处理。")})}0==t.moneypay.checked||1==t.moneypay.checked&&1==t.orderInfo.payType?"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",r,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",r),document.attachEvent("onWeixinJSBridgeReady",r)):r():1==t.moneypay.checked&&(i.localStorage.clear(),a.url("/ticket/pay_success?orderList="+JSON.stringify(t.orderList)).replace())})}else layer.msg("请选择支付方式")}}).controller("ScheduleTicketdayPay",function(e,t,a,r,o,s,n,i){var d=null===i.localStorage.getItem("saveMess")?[]:JSON.parse(i.localStorage.getItem("saveMess"));t.setObject=function(e,t){i.localStorage[e]=JSON.stringify(t),r.go("schedule_opened")},t.agreeStatus=!0,t.agreeStatusChange=function(){t.agreeStatus=!t.agreeStatus},t.orderInfo={payType:"0"},t.status=!1,s.post("api/busline/queryCycleBusScheduleSinglePrice",{userid:e.session.user.userInfo.userid,bsid:o.bsid},function(e){var a={bsid:e.busSchedule.bsid,linename:e.busSchedule.linename,depart:e.busSchedule.departaddr,arrive:e.busSchedule.arriveaddr,totalMoney:e.totalpay,plateNum:e.busSchedule.platenum,goDepartTime:e.busSchedule.departtime,backDepartTime:e.busSchedule.backDeparttime,startDate:e.startdate,endDate:e.enddate,price:e.busSchedule.price,chargingtype:e.busSchedule.chargingtype},r=new Date(e.usedate);if(a.year=r.getFullYear(),a.month=r.getMonth()+1,a.day=r.getDate(),a.chargingtype=o.chargingtype,t.status=!0,d.length>0)for(var s=0;s<d.length;s++){if(a.bsid!=d[s].bsid){d.push(a);break}layer.msg("请勿重复选择车票")}else d.push(a);t.orderList=d;for(var i=0,c=0;c<t.orderList.length;c++)i+=t.orderList[c].totalMoney;t.ticketmoney=i;for(var u=[],l=0;l<d.length;l++)u.push(d[l].bsid+"&"+n("date")(d[l].startDate,"yyyy-MM-dd")+"&"+d[l].chargingtype);t.tickeObj=u}),t.submitOrder=function(){s.post("api/busline/buySingleTicket",{userid:e.session.user.userInfo.userid,openid:e.session.user.userInfo.openid,bsid:t.tickeObj},function(e){function r(){WeixinJSBridge.invoke("getBrandWCPayRequest",e,function(r){"get_brand_wcpay_request:ok"==r.err_msg?s.post("api/recharge/verifyWxorderStatus",{rechargeid:e.rechargeid},function(e){i.localStorage.clear(),a.url("/ticket/pay_success?orderInfo="+JSON.stringify(t.orderInfo)).replace()},function(e){alert("支付失败，请联系客服处理。")}):"get_brand_wcpay_request:cancel"==r.err_msg?alert("你取消了本次支付"):alert("支付失败，请联系客服处理。")})}"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",r,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",r),document.attachEvent("onWeixinJSBridgeReady",r)):r()})}}).controller("ScheduleDetailController",function(e,t,a,r,o,s,n,i,d,c){r.mode=o.mode;var u=null,l=null;r.goSchedule={},r.goLine={},r.backLine={},r.stopStationobj=JSON.parse(o.stopStationobj),r.init=function(){for(var e=0,t=parseInt(r.stopStationobj.startIndex)+1;t<=r.stopStationobj.endIndex;t++)e+=r.stopStationobj.stopstation[t].price;r.addprice=e;for(var a=0,o=parseInt(r.stopStationobj.startIndex)+1;o<=r.stopStationobj.endIndex;o++)a+=r.stopStationobj.stopstation[o].driverTime;r.addtime=a},r.init(),r.expandStatus=!1;var m={clearMap:function(){u.clearMap()},addMarkers:function(e){for(var t=0,a=e.length;t<a;t++){var r="<div class='marker station-marker'>"+t+"</div>";0==t?r="<div class='marker start-marker'>起</div>":t==a-1&&(r="<div class='marker stop-marker'>终</div>");new AMap.Marker({map:u,position:new AMap.LngLat(e[t].lng,e[t].lat),content:r,extData:e[t],draggable:!1})}},addPolyline:function(e){(e=new AMap.Polyline({path:e,strokeColor:"#3366FF",strokeOpacity:1,strokeWeight:5,strokeStyle:"solid",strokeDasharray:[10,5]})).setMap(u),u.setFitView()},drivingSearch:function(e){i.show();var t=e.length;if(t>1){for(var a=new AMap.LngLat(e[0].stalongitude,e[0].stalatitude),r=new AMap.LngLat(e[t-1].stalongitude,e[t-1].stalatitude),o=[],s=1;s<t-1;s++)o.push(new AMap.LngLat(e[s].stalongitude,e[s].stalatitude));l.search(a,r,{waypoints:o},function(){i.hide(),u.setFitView()})}else alert("读取线路数据出错")}};i.show(),d.post("api/busline/queryCycleBusScheduleInfo",{bsid:r.stopStationobj.bsid},function(e){r.busSchedule=e.busSchedule,r.busStations=e.busStations,console.log(r.busStations),u=new AMap.Map("J_map_canvas",{zoom:14,animateEnable:!1,center:[114.530266,30.498785]}),AMap.plugin(["AMap.ToolBar"],function(){u.addControl(new AMap.ToolBar({offset:new AMap.Pixel(10,150)}))}),l=new AMap.Driving({map:u}),m.drivingSearch(r.busStations)});c(function(){d.postNoLoad("api/busline/queryCarLocation",{carid:r.busSchedule.carid},function(e){if(console.log(e),t)t.setPosition(r.lnglat.split(","));else var t=new AMap.Marker({map:u,position:[e.car.currlon,e.car.currlat],content:"<div class='bus-image marker '></div>",draggable:!1})})},1e4),r.baoming=function(){if(void 0==a.session.user.userInfo){var e=encodeURIComponent("/schedule/detail?bsid="+r.stopStationobj.bsid+"&mode=1");s.url("/auth/login?url="+e)}else d.post("api/userEnrollBusline/userEnrollBusline",{userid:a.session.user.userInfo.userid,phone:a.session.user.userInfo.phone,lineid:r.busSchedule.lineid,bsid:r.busSchedule.bsid},function(e){s.url("/signup_success?bsid="+r.stopStationobj.bsid)})},r.oldIndex=0,r.oldIndexs=0,r.expand=function(){r.expandStatus=!r.expandStatus,1==r.expandStatus?u.panBy(0,140):u.panBy(0,-140)},r.RideactiveStations=function(e){r.busStations[r.oldIndex].active=!1,r.busStations[e].active=!0,r.oldIndex=e,u.setZoom(18),u.setCenter([r.busStations[e].stalongitude,r.busStations[e].stalatitude]),u.panBy(0,140)},r.$watch("stopStationobj.startIndex",function(e,t){(r.stopStationobj.startIndex==r.stopStationobj.endIndex||r.stopStationobj.startIndex>r.stopStationobj.endIndex)&&(r.stopStationobj.startIndex=t,r.init())}),r.$watch("stopStationobj.endIndex",function(e,t){(r.stopStationobj.startIndex==r.stopStationobj.endIndex||r.stopStationobj.startIndex>r.stopStationobj.endIndex)&&(r.stopStationobj.endIndex=t,r.init())}),r.selectstartadd=function(){r.stopStationobj.stopstation[r.stopStationobj.startIndex];r.stopStationobj.startIndex>r.stopStationobj.endIndex?layer.msg("起始位置不能超过终点位置"):r.stopStationobj.startIndex==r.stopStationobj.endIndex&&layer.msg("选择的地点信息不能相同"),r.init()},r.selectendadd=function(){r.stopStationobj.stopstation[r.stopStationobj.endIndex],parseInt(r.stopStationobj.endIndex);r.stopStationobj.startIndex>r.stopStationobj.endIndex?layer.msg("终点位置不能早于起始位置"):r.stopStationobj.startIndex==r.stopStationobj.endIndex&&layer.msg("选择的地点信息不能相同"),r.init()},r.showLocation=function(e){var t=e.stalongitude+","+e.stalatitude,a=e.stationname;window.location.href="http://m.amap.com/navi/?start=&dest="+t+"&destName="+a+"&naviBy=bus&key=1a5cdec55ebac9dbd85652429f54d4d1"}});