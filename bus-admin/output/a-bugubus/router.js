app.run(function($rootScope,$state,$stateParams,$localStorage,$http,$myHttpService){$http.defaults.headers.common.Authorization="Basic "+$localStorage.auth,$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.$on("$stateChangeSuccess",function(event,to,toParams,from,fromParams){$rootScope.previousState=from,$rootScope.previousStateParams=fromParams}),$rootScope.$on("$stateChangeStart",function(event,toState){var urls=toState.name.split(".");urls.length>0&&"auth"!=urls[0]&&void 0==$rootScope.session_user&&$myHttpService.get("auth/check",{},function(data){null==data?$state.go("auth.login"):$rootScope.session_user=data})}),$rootScope.logout=function(){$myHttpService.get("auth/logout",{},function(){$rootScope.session_user=void 0,$state.go("auth.login")})}}).config(function($stateProvider,$urlRouterProvider){var basePath="a-bugubus/";$urlRouterProvider.otherwise("/auth/login"),$stateProvider.state("error",{"abstract":!0,url:"/error",template:'<div ui-view class="fade-in"></div>'}).state("error.404",{url:"/404",templateUrl:basePath+"error/404.html"}).state("auth",{"abstract":!0,url:"/auth",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load("a-bugubus/auth/controller.js")}]}}).state("auth.loading",{url:"/loading",templateUrl:basePath+"auth/loading.html"}).state("auth.login",{url:"/login",templateUrl:basePath+"auth/login.html"}).state("app",{"abstract":!0,url:"/app",templateUrl:basePath+"app.html"}).state("app.dashboard",{url:"/dashboard",templateUrl:basePath+"dashboard.html",ncyBreadcrumb:{label:'<i class="fa fa-home"></i> 首页'}}).state("app.driver",{url:"/driver",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load("a-bugubus/driver/controller.js")}]}}).state("app.driver.list",{url:"/list",cache:!1,templateUrl:basePath+"driver/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"司机列表"}}).state("app.driver.add",{url:"/add",templateUrl:basePath+"driver/edit.html",ncyBreadcrumb:{parent:"app.driver.list",label:"添加司机"}}).state("app.driver.edit",{url:"/edit/{id}",templateUrl:basePath+"driver/edit.html",ncyBreadcrumb:{parent:"app.driver.list",label:"编辑司机"}}).state("app.driver.detail",{url:"/detail/{id}",templateUrl:basePath+"driver/detail.html",ncyBreadcrumb:{parent:"app.driver.list",label:"司机详情"}}).state("app.route",{"abstract":!0,url:"/route",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"route/controller.js")}]}}).state("app.route.list",{url:"/list",templateUrl:basePath+"route/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"线路列表"}}).state("app.route.create_list",{url:"/create_list",templateUrl:basePath+"route/create_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"线路报名"}}).state("layout",{"abstract":!0,url:"/layout",templateUrl:basePath+"a-blocks/layout.html",resolve:{deps:["uiLoad",function(uiLoad){return uiLoad.load(["vendor/jquery/sortable/jquery.sortable.js",basePath+"route/controller.js"])}]}}).state("layout.route_add",{url:"/route_add",views:{"":{templateUrl:basePath+"route/edit.html"},footer:{templateUrl:basePath+"a-blocks/layout_footer_fullwidth.html"}}}).state("layout.route_edit",{url:"/route_edit/{id}",views:{"":{templateUrl:basePath+"route/edit.html"},footer:{templateUrl:basePath+"a-blocks/layout_footer_fullwidth.html"}}}).state("app.schedule",{"abstract":!0,url:"/schedule",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"schedule/controller.js")}]}}).state("app.schedule.list",{url:"/list",templateUrl:basePath+"schedule/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"排班列表"}}).state("app.schedule.add",{url:"/add",templateUrl:basePath+"schedule/edit.html",ncyBreadcrumb:{parent:"app.schedule.list",label:"添加排班"}}).state("app.schedule.edit",{url:"/edit/{id}",templateUrl:basePath+"schedule/edit.html",ncyBreadcrumb:{parent:"app.schedule.list",label:"编辑排班"}}).state("app.bus",{"abstract":!0,url:"/bus",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load([basePath+"bus/controller.js"])}]}}).state("app.bus.list",{url:"/list",templateUrl:basePath+"bus/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"车辆列表"}}).state("app.bus.add",{url:"/add",templateUrl:basePath+"bus/edit.html",ncyBreadcrumb:{parent:"app.bus.list",label:"添加车辆"}}).state("app.bus.edit",{url:"/edit/{id}",templateUrl:basePath+"bus/edit.html",ncyBreadcrumb:{parent:"app.bus.list",label:"编辑车辆"}}).state("app.bus.historical",{url:"/historical",templateUrl:basePath+"bus/historical.html",ncyBreadcrumb:{parent:"",label:"轨迹回放"}}).state("app.bus.position",{url:"/position/{carId}",templateUrl:basePath+"bus/position.html",ncyBreadcrumb:{parent:"app.bus.list",label:"位置信息"}}).state("app.user",{"abstract":!0,url:"/user",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"user/controller.js")}]}}).state("app.user.add",{url:"/add",templateUrl:basePath+"user/edit.html",ncyBreadcrumb:{parent:"app.user.user_list",label:"添加用户"}}).state("app.user.edit",{url:"/edit/{id}",templateUrl:basePath+"user/edit.html",ncyBreadcrumb:{parent:"app.user.user_list",label:"编辑用户"}}).state("app.user.adds",{url:"/adds",templateUrl:basePath+"user/adds.html",ncyBreadcrumb:{parent:"app.user.user_list",label:"批量添加用户"}}).state("app.user.user_list",{url:"/user_list",templateUrl:basePath+"user/user_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"用户管理"}}).state("app.company",{"abstract":!0,url:"/source",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"company/controller.js")}]}}).state("app.company.list",{url:"/list",templateUrl:basePath+"company/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"单位管理"}}).state("app.company.add",{url:"/add",templateUrl:basePath+"company/add.html",ncyBreadcrumb:{parent:"app.dashboard",label:"添加单位"}})});